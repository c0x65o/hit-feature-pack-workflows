'use client';
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useUi } from '@hit/ui-kit';
import { Activity, Inbox, Workflow, Clock, CheckCircle2, AlertTriangle, ArrowRight, } from 'lucide-react';
import { useAllWorkflowRuns } from '../hooks/useWorkflowRuns';
export function Dashboard({ onNavigate }) {
    const { Page, Card, Button, Badge } = useUi();
    const { runs, loading } = useAllWorkflowRuns({ limit: 5 });
    const navigate = (path) => {
        if (onNavigate)
            onNavigate(path);
        else if (typeof window !== 'undefined')
            window.location.href = path;
    };
    // Compute stats
    const recentRuns = runs.slice(0, 5);
    const runningCount = runs.filter((r) => r.status === 'running').length;
    const waitingCount = runs.filter((r) => r.status === 'waiting').length;
    const failedCount = runs.filter((r) => r.status === 'failed').length;
    return (_jsxs(Page, { title: "Workflows", description: "Orchestrate business processes with approval gates and human-in-the-loop steps", actions: _jsxs(Button, { variant: "primary", onClick: () => navigate('/workflows/runs'), children: [_jsx(Activity, { size: 16, className: "mr-2" }), "View All Runs"] }), children: [_jsxs("div", { className: "grid grid-cols-1 md:grid-cols-4 gap-4 mb-6", children: [_jsx(Card, { className: "p-4", children: _jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg", children: _jsx(Activity, { size: 20, className: "text-blue-600 dark:text-blue-400" }) }), _jsxs("div", { children: [_jsx("div", { className: "text-2xl font-bold", children: loading ? '—' : runningCount }), _jsx("div", { className: "text-sm text-gray-500", children: "Running" })] })] }) }), _jsx(Card, { className: "p-4", children: _jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "p-2 bg-amber-50 dark:bg-amber-900/20 rounded-lg", children: _jsx(Clock, { size: 20, className: "text-amber-600 dark:text-amber-400" }) }), _jsxs("div", { children: [_jsx("div", { className: "text-2xl font-bold", children: loading ? '—' : waitingCount }), _jsx("div", { className: "text-sm text-gray-500", children: "Awaiting Approval" })] })] }) }), _jsx(Card, { className: "p-4", children: _jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "p-2 bg-red-50 dark:bg-red-900/20 rounded-lg", children: _jsx(AlertTriangle, { size: 20, className: "text-red-600 dark:text-red-400" }) }), _jsxs("div", { children: [_jsx("div", { className: "text-2xl font-bold", children: loading ? '—' : failedCount }), _jsx("div", { className: "text-sm text-gray-500", children: "Failed" })] })] }) }), _jsx(Card, { className: "p-4", children: _jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "p-2 bg-purple-50 dark:bg-purple-900/20 rounded-lg", children: _jsx(Inbox, { size: 20, className: "text-purple-600 dark:text-purple-400" }) }), _jsxs("div", { children: [_jsx("button", { onClick: () => navigate('/workflows/approvals'), className: "text-2xl font-bold text-purple-600 dark:text-purple-400 hover:underline", children: "My Approvals \u2192" }), _jsx("div", { className: "text-sm text-gray-500", children: "Action Required" })] })] }) })] }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6 mb-6", children: [_jsxs(Card, { children: [_jsxs("h3", { className: "text-lg font-semibold mb-4 flex items-center gap-2", children: [_jsx(Activity, { size: 20, className: "text-blue-500" }), "Recent Runs"] }), loading ? (_jsx("div", { className: "text-center py-8 text-gray-500", children: "Loading..." })) : recentRuns.length === 0 ? (_jsxs("div", { className: "text-center py-8 text-gray-500", children: [_jsx(Workflow, { size: 32, className: "mx-auto mb-2 opacity-50" }), _jsx("p", { children: "No workflow runs yet" })] })) : (_jsxs("div", { className: "space-y-2", children: [recentRuns.map((run) => (_jsxs("button", { onClick: () => navigate(`/workflows/runs/${run.id}`), className: "w-full text-left flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors", children: [_jsxs("div", { className: "flex items-center gap-3", children: [run.status === 'running' && _jsx(Activity, { size: 16, className: "text-blue-500" }), run.status === 'waiting' && _jsx(Clock, { size: 16, className: "text-amber-500" }), run.status === 'completed' && _jsx(CheckCircle2, { size: 16, className: "text-emerald-500" }), run.status === 'failed' && _jsx(AlertTriangle, { size: 16, className: "text-red-500" }), _jsxs("div", { children: [_jsx("div", { className: "font-medium text-sm", children: run.workflowName || run.id.slice(0, 8) }), _jsx("div", { className: "text-xs text-gray-500", children: new Date(run.startedAt).toLocaleString() })] })] }), _jsx(Badge, { variant: run.status === 'completed'
                                                    ? 'success'
                                                    : run.status === 'failed'
                                                        ? 'error'
                                                        : run.status === 'waiting'
                                                            ? 'warning'
                                                            : 'info', children: run.status })] }, run.id))), _jsxs("button", { onClick: () => navigate('/workflows/runs'), className: "w-full text-center text-sm text-blue-600 dark:text-blue-400 hover:underline py-2", children: ["View all runs ", _jsx(ArrowRight, { size: 14, className: "inline ml-1" })] })] }))] }), _jsxs(Card, { children: [_jsxs("h3", { className: "text-lg font-semibold mb-4 flex items-center gap-2", children: [_jsx(Workflow, { size: 20, className: "text-purple-500" }), "Getting Started"] }), _jsxs("div", { className: "space-y-4", children: [_jsxs("div", { className: "p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg", children: [_jsx("h4", { className: "font-medium mb-2", children: "What are Workflows?" }), _jsx("p", { className: "text-sm text-gray-600 dark:text-gray-400 mb-3", children: "Workflows let you automate multi-step business processes with built-in approval gates, human-in-the-loop steps, and audit trails." }), _jsxs("ul", { className: "text-sm text-gray-600 dark:text-gray-400 space-y-1", children: [_jsx("li", { children: "\u2022 Trigger workflows from events or manually" }), _jsx("li", { children: "\u2022 Pause for approvals (HR, manager, etc.)" }), _jsx("li", { children: "\u2022 Track every step with a visual timeline" }), _jsx("li", { children: "\u2022 ACL-driven permissions per workflow" })] })] }), _jsxs("div", { className: "grid grid-cols-2 gap-3", children: [_jsxs("button", { onClick: () => navigate('/workflows/runs'), className: "flex items-center justify-center gap-2 p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors", children: [_jsx(Activity, { size: 18, className: "text-blue-500" }), _jsx("span", { className: "font-medium text-sm", children: "View Runs" })] }), _jsxs("button", { onClick: () => navigate('/workflows/approvals'), className: "flex items-center justify-center gap-2 p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors", children: [_jsx(Inbox, { size: 18, className: "text-purple-500" }), _jsx("span", { className: "font-medium text-sm", children: "My Approvals" })] })] })] })] })] })] }));
}
export default Dashboard;
